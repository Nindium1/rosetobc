// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider  = "postgresql"
    url       = env("DATABASE_URL")
    directUrl = env("DIRECT_URL")
}

model Admin {
    id        String   @id @default(cuid())
    email     String   @unique
    password  String
    name      String
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model MembershipRequest {
    id        String        @id @default(cuid())
    name      String
    email     String
    reason    String        @db.Text
    status    RequestStatus @default(PENDING)
    createdAt DateTime      @default(now())
    updatedAt DateTime      @updatedAt

    @@index([status])
}

model Book {
    id          String   @id @default(cuid())
    title       String
    author      String
    description String?  @db.Text
    imageUrl    String?
    createdAt   DateTime @default(now())
    updatedAt   DateTime @updatedAt
    reviews     Review[]

    @@index([createdAt])
}

model Review {
    id        String       @id @default(cuid())
    bookId    String
    book      Book         @relation(fields: [bookId], references: [id], onDelete: Cascade)
    reviewer  String
    rating    Int
    comment   String       @db.Text
    status    ReviewStatus @default(PENDING)
    createdAt DateTime     @default(now())
    updatedAt DateTime     @updatedAt

    @@index([bookId])
    @@index([status])
}

enum RequestStatus {
    PENDING
    APPROVED
    REJECTED
}

enum ReviewStatus {
    PENDING
    APPROVED
    REJECTED
}
